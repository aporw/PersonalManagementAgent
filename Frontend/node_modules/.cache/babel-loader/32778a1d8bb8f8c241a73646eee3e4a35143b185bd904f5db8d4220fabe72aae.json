{"ast":null,"code":"var _jsxFileName = \"/Users/ankurporwal/Documents/AIConsultation/Frontend/src/components/layout/RightPanel.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useState, useEffect } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { journalEntries as seededJournal } from \"../../data/journal\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MODE_HINTS = {\n  exploring_options: {\n    label: \"Exploration\",\n    description: \"You're clarifying ideas and understanding the problem space.\",\n    suggestions: [\"Ask why this problem matters\", \"Challenge your assumptions\", \"Explore alternative angles\"]\n  },\n  overwhelmed: {\n    label: \"Overwhelmed\",\n    description: \"You're feeling overloaded or uncertain about where to start.\",\n    suggestions: [\"Identify the smallest next step\", \"Prioritize ruthlessly\", \"Take a short break and return with fresh eyes\"]\n  },\n  reflective: {\n    label: \"Reflection\",\n    description: \"You're processing past actions or thoughts.\",\n    suggestions: [\"What worked well?\", \"What would you change?\", \"What pattern do you notice?\"]\n  },\n  decisive: {\n    label: \"Decision Making\",\n    description: \"You're evaluating options and moving toward a choice.\",\n    suggestions: [\"List pros and cons\", \"Define success criteria\", \"Identify irreversible decisions\"]\n  }\n};\nexport default function RightPanel({\n  mode,\n  summary: propSummary = null,\n  threads = []\n}) {\n  _s();\n  var _threads$0$thread_id, _threads$, _entries$, _ref, _ref2, _fetchedSummary$curre, _fetchedSummary$what_, _propSummary$key_poin, _fetchedSummary$sugge;\n  const modeConfig = mode ? MODE_HINTS[mode] : null;\n\n  // API base: allow overriding via `REACT_APP_API_BASE` or window.API_BASE\n  const API_BASE = typeof window !== \"undefined\" && window.API_BASE || process.env.REACT_APP_API_BASE || \"http://localhost:8000\";\n  const [openFull, setOpenFull] = useState(false);\n  const [entries, setEntries] = useState([]);\n  const [selectedEntry, setSelectedEntry] = useState(null);\n  const [modalWidth, setModalWidth] = useState(75); // vw\n  const [showNewForm, setShowNewForm] = useState(false);\n  const [newTitle, setNewTitle] = useState(\"\");\n  const [newContent, setNewContent] = useState(\"\");\n  const [fontChoice, setFontChoice] = useState(\"Patrick Hand\");\n\n  // editing state\n  const [editingEntryId, setEditingEntryId] = useState(null);\n  const [editTitle, setEditTitle] = useState(\"\");\n  const [editContent, setEditContent] = useState(\"\");\n\n  // summary / threads\n  const [selectedThreadId, setSelectedThreadId] = useState((_threads$0$thread_id = threads === null || threads === void 0 ? void 0 : (_threads$ = threads[0]) === null || _threads$ === void 0 ? void 0 : _threads$.thread_id) !== null && _threads$0$thread_id !== void 0 ? _threads$0$thread_id : \"t1\");\n  const [loadingSummary, setLoadingSummary] = useState(false);\n  const [fetchedSummary, setFetchedSummary] = useState({});\n\n  // load entries from localStorage or seeded\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem(\"ai_journal_entries\");\n      if (raw) {\n        setEntries(JSON.parse(raw));\n      } else {\n        setEntries(seededJournal);\n      }\n    } catch (e) {\n      setEntries(seededJournal);\n    }\n  }, []);\n\n  // persist helper\n  function persistEntries(next) {\n    setEntries(next);\n    try {\n      localStorage.setItem(\"ai_journal_entries\", JSON.stringify(next));\n    } catch (e) {\n      /* ignore */\n    }\n  }\n  function startEdit(entry) {\n    setSelectedEntry(entry);\n    setEditingEntryId(entry.entry_id);\n    setEditTitle(entry.title);\n    setEditContent(entry.content);\n  }\n  function saveEdit(entryId) {\n    var _next$find;\n    const next = entries.map(en => en.entry_id === entryId ? {\n      ...en,\n      title: editTitle,\n      content: editContent\n    } : en);\n    persistEntries(next);\n    setEditingEntryId(null);\n    const updated = (_next$find = next.find(n => n.entry_id === entryId)) !== null && _next$find !== void 0 ? _next$find : null;\n    setSelectedEntry(updated);\n  }\n  function cancelEdit() {\n    setEditingEntryId(null);\n    setEditTitle(\"\");\n    setEditContent(\"\");\n  }\n  function deleteEntry(entryId) {\n    if (!window.confirm(\"Delete this journal entry?\")) return;\n    const next = entries.filter(e => e.entry_id !== entryId);\n    persistEntries(next);\n    if ((selectedEntry === null || selectedEntry === void 0 ? void 0 : selectedEntry.entry_id) === entryId) {\n      var _next$;\n      setSelectedEntry((_next$ = next[0]) !== null && _next$ !== void 0 ? _next$ : null);\n    }\n  }\n  const latestEntry = (_entries$ = entries[0]) !== null && _entries$ !== void 0 ? _entries$ : null;\n\n  // modal width + font choice persistence\n  useEffect(() => {\n    try {\n      const w = localStorage.getItem(\"ai_journal_modal_width\");\n      if (w) setModalWidth(Number(w));\n    } catch (e) {}\n  }, []);\n  useEffect(() => {\n    try {\n      const f = localStorage.getItem(\"ai_journal_font\");\n      if (f) setFontChoice(f);\n    } catch (e) {}\n  }, []);\n  useEffect(() => {\n    try {\n      localStorage.setItem(\"ai_journal_modal_width\", String(modalWidth));\n    } catch (e) {}\n  }, [modalWidth]);\n  useEffect(() => {\n    try {\n      localStorage.setItem(\"ai_journal_font\", fontChoice);\n    } catch (e) {}\n  }, [fontChoice]);\n\n  // keep selectedThreadId in sync if threads prop changes\n  useEffect(() => {\n    if (threads && threads.length > 0) {\n      setSelectedThreadId(s => s || threads[0].thread_id);\n    }\n  }, [threads]);\n  async function fetchSummaryForThread(threadId) {\n    setLoadingSummary(true);\n    const USER_ID = localStorage.getItem(\"user_id\") || \"u1\";\n    try {\n      // fetch stored messages for the thread, then POST them to /summary so we explicitly pass the chat\n      const msgsRes = await fetch(`${API_BASE}/messages/${encodeURIComponent(USER_ID)}/${encodeURIComponent(threadId)}`);\n      if (!msgsRes.ok) {\n        throw new Error(\"Failed to load messages\");\n      }\n      const msgsJson = await msgsRes.json();\n      const conversation = (msgsJson.messages || []).map(m => ({\n        role: m.role || \"user\",\n        content: m.content || \"\"\n      }));\n      const summaryRes = await fetch(`${API_BASE}/summary`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Accept: \"application/json\"\n        },\n        body: JSON.stringify({\n          conversation\n        })\n      });\n      if (!summaryRes.ok) {\n        // try to extract error details from the response body\n        let errBody = \"\";\n        try {\n          const t = await summaryRes.text();\n          errBody = t;\n        } catch (e) {\n          errBody = String(e);\n        }\n        console.error(\"summary error\", summaryRes.status, errBody);\n        setFetchedSummary({\n          current_state: `Error loading summary (${summaryRes.status}): ${errBody}`,\n          what_we_uncovered: \"\",\n          suggested_next_steps: \"\"\n        });\n      } else {\n        var _parsed$summary, _parsed$summary2, _parsed$summary3;\n        const data = await summaryRes.json();\n        // backend returns a JSON string in `summary` field (structured inside); handle both shapes\n        let parsed = {};\n        try {\n          parsed = typeof data.summary === \"string\" ? JSON.parse(data.summary) : data;\n        } catch (e) {\n          parsed = data;\n        }\n        setFetchedSummary({\n          current_state: parsed.current_state || ((_parsed$summary = parsed.summary) === null || _parsed$summary === void 0 ? void 0 : _parsed$summary.current_state) || \"\",\n          what_we_uncovered: parsed.what_we_uncovered || ((_parsed$summary2 = parsed.summary) === null || _parsed$summary2 === void 0 ? void 0 : _parsed$summary2.what_we_uncovered) || \"\",\n          suggested_next_steps: parsed.suggested_next_steps || ((_parsed$summary3 = parsed.summary) === null || _parsed$summary3 === void 0 ? void 0 : _parsed$summary3.suggested_next_steps) || \"\"\n        });\n      }\n    } catch (e) {\n      console.error(e);\n      setFetchedSummary({\n        current_state: \"Error contacting server\",\n        what_we_uncovered: \"\",\n        suggested_next_steps: \"\"\n      });\n    } finally {\n      setLoadingSummary(false);\n    }\n  }\n\n  // auto-load initial thread summary when selectedThreadId changes\n  useEffect(() => {\n    if (selectedThreadId) {\n      fetchSummaryForThread(selectedThreadId);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedThreadId]);\n  return /*#__PURE__*/_jsxDEV(\"aside\", {\n    className: \"right-panel\",\n    children: [/*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"right-panel__section\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"info-tile current-state\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"current-state-head\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: 8\n              },\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"highlights-btn\",\n                onClick: () => fetchSummaryForThread(selectedThreadId),\n                disabled: loadingSummary,\n                \"aria-label\": \"Update Highlights\",\n                children: loadingSummary ? \"Loading…\" : \"Update Highlights\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 265,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n              style: {\n                margin: 0\n              },\n              children: \"Current State\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"state-controls\",\n            style: {\n              display: \"flex\",\n              gap: 8,\n              alignItems: \"center\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"state-ornament\",\n              \"aria-hidden\": true,\n              children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                width: \"54\",\n                height: \"54\",\n                viewBox: \"0 0 24 24\",\n                fill: \"none\",\n                xmlns: \"http://www.w3.org/2000/svg\",\n                children: [/*#__PURE__*/_jsxDEV(\"path\", {\n                  d: \"M12 2v6l4 2\",\n                  stroke: \"rgba(123,97,255,0.18)\",\n                  strokeWidth: \"1.4\",\n                  strokeLinecap: \"round\",\n                  strokeLinejoin: \"round\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"circle\", {\n                  cx: \"12\",\n                  cy: \"12\",\n                  r: \"9\",\n                  stroke: \"rgba(123,97,255,0.06)\",\n                  strokeWidth: \"1.2\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 282,\n                  columnNumber: 19\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 280,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: \"flex\",\n                gap: 8,\n                alignItems: \"center\"\n              },\n              children: threads.length > 0 ? /*#__PURE__*/_jsxDEV(\"select\", {\n                value: selectedThreadId,\n                onChange: e => setSelectedThreadId(e.target.value),\n                className: \"thread-selector\",\n                children: threads.map(t => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: t.thread_id,\n                  children: t.title\n                }, t.thread_id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 294,\n                  columnNumber: 23\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 288,\n                columnNumber: 19\n              }, this) : null\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-body\",\n          children: [modeConfig ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"desc-block desc-tile\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"desc-text\",\n              children: modeConfig.description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"desc-block desc-tile\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"desc-text\",\n              children: \"You're clarifying ideas and understanding the problem space.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"info-section uncovered\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"summary-text\",\n              children: (_ref = (_ref2 = (_fetchedSummary$curre = fetchedSummary.current_state) !== null && _fetchedSummary$curre !== void 0 ? _fetchedSummary$curre : propSummary === null || propSummary === void 0 ? void 0 : propSummary.current_state) !== null && _ref2 !== void 0 ? _ref2 : propSummary === null || propSummary === void 0 ? void 0 : propSummary.summary_text) !== null && _ref !== void 0 ? _ref : \"No summary yet. Click 'Update Highlights'.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"info-section uncovered\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"What we\\u2019ve uncovered\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"summary-text\",\n              children: (_fetchedSummary$what_ = fetchedSummary.what_we_uncovered) !== null && _fetchedSummary$what_ !== void 0 ? _fetchedSummary$what_ : propSummary && (_propSummary$key_poin = propSummary.key_points) !== null && _propSummary$key_poin !== void 0 && _propSummary$key_poin.length ? propSummary.key_points.join(\"\\n\") : \"—\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 322,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"info-section suggestions\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Suggested next steps\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"summary-text\",\n              children: (_fetchedSummary$sugge = fetchedSummary.suggested_next_steps) !== null && _fetchedSummary$sugge !== void 0 ? _fetchedSummary$sugge : \"—\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 331,\n              columnNumber: 15\n            }, this), modeConfig && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginTop: 10\n              },\n              className: \"suggestion-chips\",\n              children: modeConfig.suggestions.map((s, i) => /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"suggestion-chip\",\n                onClick: () => alert(s + \" (demo)\"),\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"chip-dot\",\n                  \"aria-hidden\": true,\n                  children: \"\\u2022\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 339,\n                  columnNumber: 23\n                }, this), s]\n              }, i, true, {\n                fileName: _jsxFileName,\n                lineNumber: 338,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 329,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 261,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"right-panel__section\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"journal-tile\",\n        role: \"button\",\n        onClick: () => setOpenFull(true),\n        \"aria-pressed\": openFull,\n        tabIndex: 0,\n        onKeyDown: e => {\n          if (e.key === \"Enter\" || e.key === \" \") setOpenFull(true);\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"journal-icon big\",\n          \"aria-hidden\": true,\n          children: \"\\uD83D\\uDCD4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"journal-label\",\n          children: \"Your Journal\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 7\n    }, this), openFull && typeof document !== \"undefined\" && document.body ? /*#__PURE__*/createPortal(/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-backdrop\",\n      role: \"dialog\",\n      \"aria-modal\": \"true\",\n      onClick: () => setOpenFull(false),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `modal full-journal`,\n        style: {\n          width: `${modalWidth}vw`\n        },\n        onClick: e => e.stopPropagation(),\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Your Journal\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 378,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: \"flex\",\n              gap: 12,\n              alignItems: \"center\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"muted\",\n              style: {\n                fontSize: \"0.85rem\"\n              },\n              children: \"Width\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 380,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"range\",\n              min: 60,\n              max: 95,\n              value: modalWidth,\n              onChange: e => setModalWidth(Number(e.target.value))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 381,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"muted\",\n              style: {\n                fontSize: \"0.85rem\"\n              },\n              children: \"Font\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 388,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              className: \"font-picker\",\n              value: fontChoice,\n              onChange: e => setFontChoice(e.target.value),\n              \"aria-label\": \"Journal font picker\",\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Patrick Hand\",\n                children: \"Patrick Hand\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 390,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Indie Flower\",\n                children: \"Indie Flower\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 391,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Caveat\",\n                children: \"Caveat\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 392,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 389,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"prompt-btn\",\n              onClick: () => setOpenFull(false),\n              children: \"Close\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 379,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 377,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modal-body\",\n          style: {\n            alignItems: \"stretch\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"journal-list\",\n            style: {\n              width: \"300px\"\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"journal-list-header muted\",\n              children: \"Entries\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 400,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              children: entries.map(e => /*#__PURE__*/_jsxDEV(\"li\", {\n                className: `journal-list-item ${(selectedEntry === null || selectedEntry === void 0 ? void 0 : selectedEntry.entry_id) === e.entry_id ? \"active\" : \"\"}`,\n                onClick: () => setSelectedEntry(e),\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"jl-title\",\n                  children: e.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 404,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"jl-date muted\",\n                  children: new Date(e.created_at).toLocaleDateString()\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 405,\n                  columnNumber: 27\n                }, this)]\n              }, e.entry_id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 403,\n                columnNumber: 25\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 399,\n            columnNumber: 19\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"journal-right\",\n            style: {\n              flex: 1\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"journal-new-row\",\n              style: {\n                display: \"flex\",\n                flexDirection: \"column\",\n                gap: 8\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: \"flex\",\n                  justifyContent: \"space-between\",\n                  alignItems: \"center\"\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  style: {\n                    margin: 0\n                  },\n                  children: \"New Entry\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 414,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"prompt-btn\",\n                  onClick: () => {\n                    setShowNewForm(s => !s);\n                    setNewTitle(\"\");\n                    setNewContent(\"\");\n                  },\n                  children: showNewForm ? \"Cancel\" : \"New\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 415,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 413,\n                columnNumber: 23\n              }, this), showNewForm && /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  display: \"flex\",\n                  gap: 12\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    width: 160\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"input\", {\n                    className: \"journal-input title-input\",\n                    placeholder: \"Title\",\n                    value: newTitle,\n                    onChange: e => setNewTitle(e.target.value)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 423,\n                    columnNumber: 29\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 422,\n                  columnNumber: 27\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  style: {\n                    flex: 1\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                    className: \"journal-textarea\",\n                    placeholder: \"Write your entry...\",\n                    value: newContent,\n                    onChange: e => setNewContent(e.target.value),\n                    style: {\n                      fontFamily: fontChoice\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 426,\n                    columnNumber: 29\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: \"flex\",\n                      gap: 8,\n                      marginTop: 8\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"prompt-btn\",\n                      onClick: () => {\n                        const t = newTitle;\n                        const c = newContent;\n                        if (!t.trim() && !c.trim()) return;\n                        const entry = {\n                          entry_id: `j${Date.now()}`,\n                          linked_session_id: \"\",\n                          title: t.trim() || \"Untitled\",\n                          content: c.trim(),\n                          created_at: new Date().toISOString(),\n                          source: \"user_written\"\n                        };\n                        const next = [entry, ...entries];\n                        persistEntries(next);\n                        setSelectedEntry(entry);\n                        setShowNewForm(false);\n                        setNewTitle(\"\");\n                        setNewContent(\"\");\n                      },\n                      children: \"Save Entry\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 428,\n                      columnNumber: 31\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 427,\n                    columnNumber: 29\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 425,\n                  columnNumber: 27\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 421,\n                columnNumber: 25\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 412,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"journal-preview\",\n              style: {\n                marginTop: 12\n              },\n              children: selectedEntry ? editingEntryId === selectedEntry.entry_id ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"notebook-card\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"note-head\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      display: \"flex\",\n                      gap: 12,\n                      alignItems: \"center\"\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                      className: \"journal-input title-input\",\n                      value: editTitle,\n                      onChange: e => setEditTitle(e.target.value)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 452,\n                      columnNumber: 33\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      style: {\n                        marginLeft: \"auto\",\n                        display: \"flex\",\n                        gap: 8\n                      },\n                      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                        className: \"prompt-btn\",\n                        onClick: () => saveEdit(selectedEntry.entry_id),\n                        children: \"Save\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 454,\n                        columnNumber: 35\n                      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                        className: \"prompt-btn\",\n                        onClick: cancelEdit,\n                        children: \"Cancel\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 455,\n                        columnNumber: 35\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 453,\n                      columnNumber: 33\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 451,\n                    columnNumber: 31\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"muted\",\n                    children: new Date(selectedEntry.created_at).toLocaleString()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 458,\n                    columnNumber: 31\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 450,\n                  columnNumber: 29\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"note-body\",\n                  children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n                    className: \"journal-textarea\",\n                    value: editContent,\n                    onChange: e => setEditContent(e.target.value),\n                    style: {\n                      fontFamily: fontChoice\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 461,\n                    columnNumber: 31\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 460,\n                  columnNumber: 29\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 449,\n                columnNumber: 27\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"notebook-card\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"note-head\",\n                  style: {\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    gap: 12\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: selectedEntry.title\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 467,\n                    columnNumber: 31\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"muted\",\n                    children: new Date(selectedEntry.created_at).toLocaleString()\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 468,\n                    columnNumber: 31\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    style: {\n                      marginLeft: \"auto\",\n                      display: \"flex\",\n                      gap: 8\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"prompt-btn\",\n                      onClick: () => startEdit(selectedEntry),\n                      children: \"Edit\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 470,\n                      columnNumber: 33\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      className: \"prompt-btn\",\n                      onClick: () => deleteEntry(selectedEntry.entry_id),\n                      children: \"Delete\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 471,\n                      columnNumber: 33\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 469,\n                    columnNumber: 31\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 466,\n                  columnNumber: 29\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"note-body\",\n                  children: selectedEntry.content.split(\"\\n\").map((ln, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"note-line\",\n                    style: {\n                      fontFamily: fontChoice\n                    },\n                    children: ln\n                  }, i, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 476,\n                    columnNumber: 33\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 474,\n                  columnNumber: 29\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 465,\n                columnNumber: 27\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"muted\",\n                children: \"Select an entry from the left to view it here.\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 482,\n                columnNumber: 25\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 446,\n              columnNumber: 21\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 411,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 15\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 13\n    }, this), document.body) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 259,\n    columnNumber: 5\n  }, this);\n}\n\n// Small form component for creating a journal entry (kept local)\n_s(RightPanel, \"65NzLwV62x/XE0xnhePN17C0Vro=\");\n_c = RightPanel;\nfunction JournalForm({\n  onSave\n}) {\n  _s2();\n  const [title, setTitle] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n  function handleSave() {\n    if (!title.trim() && !content.trim()) return;\n    const entry = {\n      entry_id: `j${Date.now()}`,\n      linked_session_id: \"\",\n      title: title.trim() || \"Untitled\",\n      content: content.trim(),\n      created_at: new Date().toISOString(),\n      source: \"user_written\"\n    };\n    onSave(entry);\n    setTitle(\"\");\n    setContent(\"\");\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      className: \"journal-input\",\n      placeholder: \"Title\",\n      value: title,\n      onChange: e => setTitle(e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 518,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n      className: \"journal-textarea\",\n      placeholder: \"Write your entry...\",\n      value: content,\n      onChange: e => setContent(e.target.value)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 519,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: \"flex\",\n        gap: 8\n      },\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"prompt-btn\",\n        onClick: handleSave,\n        children: \"Save Entry\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 521,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 520,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 517,\n    columnNumber: 5\n  }, this);\n}\n_s2(JournalForm, \"eiXkh+GEjRZ8Svxty8bnXm2rLL0=\");\n_c2 = JournalForm;\nvar _c, _c2;\n$RefreshReg$(_c, \"RightPanel\");\n$RefreshReg$(_c2, \"JournalForm\");","map":{"version":3,"names":["useState","useEffect","createPortal","journalEntries","seededJournal","jsxDEV","_jsxDEV","MODE_HINTS","exploring_options","label","description","suggestions","overwhelmed","reflective","decisive","RightPanel","mode","summary","propSummary","threads","_s","_threads$0$thread_id","_threads$","_entries$","_ref","_ref2","_fetchedSummary$curre","_fetchedSummary$what_","_propSummary$key_poin","_fetchedSummary$sugge","modeConfig","API_BASE","window","process","env","REACT_APP_API_BASE","openFull","setOpenFull","entries","setEntries","selectedEntry","setSelectedEntry","modalWidth","setModalWidth","showNewForm","setShowNewForm","newTitle","setNewTitle","newContent","setNewContent","fontChoice","setFontChoice","editingEntryId","setEditingEntryId","editTitle","setEditTitle","editContent","setEditContent","selectedThreadId","setSelectedThreadId","thread_id","loadingSummary","setLoadingSummary","fetchedSummary","setFetchedSummary","raw","localStorage","getItem","JSON","parse","e","persistEntries","next","setItem","stringify","startEdit","entry","entry_id","title","content","saveEdit","entryId","_next$find","map","en","updated","find","n","cancelEdit","deleteEntry","confirm","filter","_next$","latestEntry","w","Number","f","String","length","s","fetchSummaryForThread","threadId","USER_ID","msgsRes","fetch","encodeURIComponent","ok","Error","msgsJson","json","conversation","messages","m","role","summaryRes","method","headers","Accept","body","errBody","t","text","console","error","status","current_state","what_we_uncovered","suggested_next_steps","_parsed$summary","_parsed$summary2","_parsed$summary3","data","parsed","className","children","style","marginBottom","onClick","disabled","fileName","_jsxFileName","lineNumber","columnNumber","margin","display","gap","alignItems","width","height","viewBox","fill","xmlns","d","stroke","strokeWidth","strokeLinecap","strokeLinejoin","cx","cy","r","value","onChange","target","summary_text","key_points","join","marginTop","i","alert","tabIndex","onKeyDown","key","document","stopPropagation","fontSize","type","min","max","Date","created_at","toLocaleDateString","flex","flexDirection","justifyContent","placeholder","fontFamily","c","trim","now","linked_session_id","toISOString","source","marginLeft","toLocaleString","split","ln","_c","JournalForm","onSave","_s2","setTitle","setContent","handleSave","_c2","$RefreshReg$"],"sources":["/Users/ankurporwal/Documents/AIConsultation/Frontend/src/components/layout/RightPanel.tsx"],"sourcesContent":["import { DetectedMode, SessionSummary, JournalEntry } from \"../../types/thinking\";\nimport { useState, useEffect } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { journalEntries as seededJournal } from \"../../data/journal\";\n\ninterface ThreadRef {\n  thread_id: string;\n  title: string;\n}\n\ninterface RightPanelProps {\n  mode?: DetectedMode;\n  summary?: SessionSummary | null;\n  threads?: ThreadRef[];\n}\n\nconst MODE_HINTS: Record<\n  DetectedMode,\n  {\n    label: string;\n    description: string;\n    suggestions: string[];\n  }\n> = {\n  exploring_options: {\n    label: \"Exploration\",\n    description: \"You're clarifying ideas and understanding the problem space.\",\n    suggestions: [\n      \"Ask why this problem matters\",\n      \"Challenge your assumptions\",\n      \"Explore alternative angles\",\n    ],\n  },\n  overwhelmed: {\n    label: \"Overwhelmed\",\n    description: \"You're feeling overloaded or uncertain about where to start.\",\n    suggestions: [\n      \"Identify the smallest next step\",\n      \"Prioritize ruthlessly\",\n      \"Take a short break and return with fresh eyes\",\n    ],\n  },\n  reflective: {\n    label: \"Reflection\",\n    description: \"You're processing past actions or thoughts.\",\n    suggestions: [\n      \"What worked well?\",\n      \"What would you change?\",\n      \"What pattern do you notice?\",\n    ],\n  },\n  decisive: {\n    label: \"Decision Making\",\n    description: \"You're evaluating options and moving toward a choice.\",\n    suggestions: [\n      \"List pros and cons\",\n      \"Define success criteria\",\n      \"Identify irreversible decisions\",\n    ],\n  },\n};\n\nexport default function RightPanel({\n  mode,\n  summary: propSummary = null,\n  threads = [],\n}: RightPanelProps) {\n  const modeConfig = mode ? MODE_HINTS[mode] : null;\n\n  // API base: allow overriding via `REACT_APP_API_BASE` or window.API_BASE\n  const API_BASE = (typeof window !== \"undefined\" && (window as any).API_BASE) || (process.env.REACT_APP_API_BASE as string) || \"http://localhost:8000\";\n\n  const [openFull, setOpenFull] = useState(false);\n  const [entries, setEntries] = useState<JournalEntry[]>([]);\n  const [selectedEntry, setSelectedEntry] = useState<JournalEntry | null>(null);\n  const [modalWidth, setModalWidth] = useState<number>(75); // vw\n  const [showNewForm, setShowNewForm] = useState<boolean>(false);\n  const [newTitle, setNewTitle] = useState(\"\");\n  const [newContent, setNewContent] = useState(\"\");\n  const [fontChoice, setFontChoice] = useState<string>(\"Patrick Hand\");\n\n  // editing state\n  const [editingEntryId, setEditingEntryId] = useState<string | null>(null);\n  const [editTitle, setEditTitle] = useState(\"\");\n  const [editContent, setEditContent] = useState(\"\");\n\n  // summary / threads\n  const [selectedThreadId, setSelectedThreadId] = useState<string>(\n    threads?.[0]?.thread_id ?? \"t1\"\n  );\n  const [loadingSummary, setLoadingSummary] = useState(false);\n  const [fetchedSummary, setFetchedSummary] = useState<{\n    current_state?: string;\n    what_we_uncovered?: string;\n    suggested_next_steps?: string;\n  }>({});\n\n  // load entries from localStorage or seeded\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem(\"ai_journal_entries\");\n      if (raw) {\n        setEntries(JSON.parse(raw));\n      } else {\n        setEntries(seededJournal);\n      }\n    } catch (e) {\n      setEntries(seededJournal);\n    }\n  }, []);\n\n  // persist helper\n  function persistEntries(next: JournalEntry[]) {\n    setEntries(next);\n    try {\n      localStorage.setItem(\"ai_journal_entries\", JSON.stringify(next));\n    } catch (e) {\n      /* ignore */\n    }\n  }\n\n  function startEdit(entry: JournalEntry) {\n    setSelectedEntry(entry);\n    setEditingEntryId(entry.entry_id);\n    setEditTitle(entry.title);\n    setEditContent(entry.content);\n  }\n\n  function saveEdit(entryId: string) {\n    const next = entries.map((en) =>\n      en.entry_id === entryId ? { ...en, title: editTitle, content: editContent } : en\n    );\n    persistEntries(next);\n    setEditingEntryId(null);\n    const updated = next.find((n) => n.entry_id === entryId) ?? null;\n    setSelectedEntry(updated);\n  }\n\n  function cancelEdit() {\n    setEditingEntryId(null);\n    setEditTitle(\"\");\n    setEditContent(\"\");\n  }\n\n  function deleteEntry(entryId: string) {\n    if (!window.confirm(\"Delete this journal entry?\")) return;\n    const next = entries.filter((e) => e.entry_id !== entryId);\n    persistEntries(next);\n    if (selectedEntry?.entry_id === entryId) {\n      setSelectedEntry(next[0] ?? null);\n    }\n  }\n\n  const latestEntry = entries[0] ?? null;\n\n  // modal width + font choice persistence\n  useEffect(() => {\n    try {\n      const w = localStorage.getItem(\"ai_journal_modal_width\");\n      if (w) setModalWidth(Number(w));\n    } catch (e) {}\n  }, []);\n\n  useEffect(() => {\n    try {\n      const f = localStorage.getItem(\"ai_journal_font\");\n      if (f) setFontChoice(f);\n    } catch (e) {}\n  }, []);\n\n  useEffect(() => {\n    try {\n      localStorage.setItem(\"ai_journal_modal_width\", String(modalWidth));\n    } catch (e) {}\n  }, [modalWidth]);\n\n  useEffect(() => {\n    try {\n      localStorage.setItem(\"ai_journal_font\", fontChoice);\n    } catch (e) {}\n  }, [fontChoice]);\n\n  // keep selectedThreadId in sync if threads prop changes\n  useEffect(() => {\n    if (threads && threads.length > 0) {\n      setSelectedThreadId((s) => s || threads[0].thread_id);\n    }\n  }, [threads]);\n\n  async function fetchSummaryForThread(threadId: string) {\n    setLoadingSummary(true);\n    const USER_ID = localStorage.getItem(\"user_id\") || \"u1\";\n    try {\n      // fetch stored messages for the thread, then POST them to /summary so we explicitly pass the chat\n      const msgsRes = await fetch(`${API_BASE}/messages/${encodeURIComponent(USER_ID)}/${encodeURIComponent(threadId)}`);\n      if (!msgsRes.ok) {\n        throw new Error(\"Failed to load messages\");\n      }\n      const msgsJson = await msgsRes.json();\n      const conversation = (msgsJson.messages || []).map((m: any) => ({ role: m.role || \"user\", content: m.content || \"\" }));\n\n      const summaryRes = await fetch(`${API_BASE}/summary`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\", Accept: \"application/json\" },\n        body: JSON.stringify({ conversation }),\n      });\n\n      if (!summaryRes.ok) {\n        // try to extract error details from the response body\n        let errBody = \"\";\n        try {\n          const t = await summaryRes.text();\n          errBody = t;\n        } catch (e) {\n          errBody = String(e);\n        }\n        console.error(\"summary error\", summaryRes.status, errBody);\n        setFetchedSummary({\n          current_state: `Error loading summary (${summaryRes.status}): ${errBody}`,\n          what_we_uncovered: \"\",\n          suggested_next_steps: \"\",\n        });\n      } else {\n        const data = await summaryRes.json();\n        // backend returns a JSON string in `summary` field (structured inside); handle both shapes\n        let parsed: any = {};\n        try {\n          parsed = typeof data.summary === \"string\" ? JSON.parse(data.summary) : data;\n        } catch (e) {\n          parsed = data;\n        }\n        setFetchedSummary({\n          current_state: parsed.current_state || parsed.summary?.current_state || \"\",\n          what_we_uncovered: parsed.what_we_uncovered || parsed.summary?.what_we_uncovered || \"\",\n          suggested_next_steps: parsed.suggested_next_steps || parsed.summary?.suggested_next_steps || \"\",\n        });\n      }\n    } catch (e) {\n      console.error(e);\n      setFetchedSummary({\n        current_state: \"Error contacting server\",\n        what_we_uncovered: \"\",\n        suggested_next_steps: \"\",\n      });\n    } finally {\n      setLoadingSummary(false);\n    }\n  }\n\n  // auto-load initial thread summary when selectedThreadId changes\n  useEffect(() => {\n    if (selectedThreadId) {\n      fetchSummaryForThread(selectedThreadId);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [selectedThreadId]);\n\n  return (\n    <aside className=\"right-panel\">\n      <section className=\"right-panel__section\">\n        <div className=\"info-tile current-state\">\n          <div className=\"current-state-head\">\n            <div>\n              <div style={{ marginBottom: 8 }}>\n                <button\n                  className=\"highlights-btn\"\n                  onClick={() => fetchSummaryForThread(selectedThreadId)}\n                  disabled={loadingSummary}\n                  aria-label=\"Update Highlights\"\n                >\n                  {loadingSummary ? \"Loading…\" : \"Update Highlights\"}\n                </button>\n              </div>\n              <h3 style={{ margin: 0 }}>Current State</h3>\n            </div>\n\n            <div className=\"state-controls\" style={{ display: \"flex\", gap: 8, alignItems: \"center\" }}>\n              <div className=\"state-ornament\" aria-hidden>\n                {/* decorative SVG */}\n                <svg width=\"54\" height=\"54\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                  <path d=\"M12 2v6l4 2\" stroke=\"rgba(123,97,255,0.18)\" strokeWidth=\"1.4\" strokeLinecap=\"round\" strokeLinejoin=\"round\" />\n                  <circle cx=\"12\" cy=\"12\" r=\"9\" stroke=\"rgba(123,97,255,0.06)\" strokeWidth=\"1.2\" />\n                </svg>\n              </div>\n\n              <div style={{ display: \"flex\", gap: 8, alignItems: \"center\" }}>\n                {threads.length > 0 ? (\n                  <select\n                    value={selectedThreadId}\n                    onChange={(e) => setSelectedThreadId(e.target.value)}\n                    className=\"thread-selector\"\n                  >\n                    {threads.map((t) => (\n                      <option key={t.thread_id} value={t.thread_id}>\n                        {t.title}\n                      </option>\n                    ))}\n                  </select>\n                ) : null}\n              </div>\n            </div>\n          </div>\n\n          <div className=\"info-body\">\n            {modeConfig ? (\n              <div className=\"desc-block desc-tile\">\n                <div className=\"desc-text\">{modeConfig.description}</div>\n              </div>\n            ) : (\n              <div className=\"desc-block desc-tile\">\n                <div className=\"desc-text\">You're clarifying ideas and understanding the problem space.</div>\n              </div>\n            )}\n\n            <div className=\"info-section uncovered\">\n              <div className=\"summary-text\">\n                {fetchedSummary.current_state ?? (propSummary as any)?.current_state ?? (propSummary as any)?.summary_text ?? \"No summary yet. Click 'Update Highlights'.\"}\n              </div>\n            </div>\n\n\n            <div className=\"info-section uncovered\">\n              <h4>What we’ve uncovered</h4>\n              <div className=\"summary-text\">\n                {fetchedSummary.what_we_uncovered ?? (propSummary && propSummary.key_points?.length ? propSummary.key_points.join(\"\\n\") : \"—\")}\n              </div>\n            </div>\n\n            <div className=\"info-section suggestions\">\n              <h4>Suggested next steps</h4>\n              <div className=\"summary-text\">\n                {fetchedSummary.suggested_next_steps ?? \"—\"}\n              </div>\n\n              {modeConfig && (\n                <div style={{ marginTop: 10 }} className=\"suggestion-chips\">\n                  {modeConfig.suggestions.map((s, i) => (\n                    <button key={i} className=\"suggestion-chip\" onClick={() => alert(s + \" (demo)\")}>\n                      <span className=\"chip-dot\" aria-hidden>•</span>\n                      {s}\n                    </button>\n                  ))}\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </section>\n\n      {/* Journal tile */}\n      <section className=\"right-panel__section\">\n        <div\n          className=\"journal-tile\"\n          role=\"button\"\n          onClick={() => setOpenFull(true)}\n          aria-pressed={openFull}\n          tabIndex={0}\n          onKeyDown={(e) => {\n            if (e.key === \"Enter\" || e.key === \" \") setOpenFull(true);\n          }}\n        >\n          <div className=\"journal-icon big\" aria-hidden>\n            📔\n          </div>\n          <div className=\"journal-label\">Your Journal</div>\n        </div>\n      </section>\n\n      {openFull && typeof document !== \"undefined\" && document.body\n        ? createPortal(\n            <div className=\"modal-backdrop\" role=\"dialog\" aria-modal=\"true\" onClick={() => setOpenFull(false)}>\n              <div\n                className={`modal full-journal`}\n                style={{ width: `${modalWidth}vw` }}\n                onClick={(e) => e.stopPropagation()}\n              >\n                <div className=\"modal-header\">\n                  <h3>Your Journal</h3>\n                  <div style={{ display: \"flex\", gap: 12, alignItems: \"center\" }}>\n                    <label className=\"muted\" style={{ fontSize: \"0.85rem\" }}>Width</label>\n                    <input\n                      type=\"range\"\n                      min={60}\n                      max={95}\n                      value={modalWidth}\n                      onChange={(e) => setModalWidth(Number(e.target.value))}\n                    />\n                    <label className=\"muted\" style={{ fontSize: \"0.85rem\" }}>Font</label>\n                    <select className=\"font-picker\" value={fontChoice} onChange={(e) => setFontChoice(e.target.value)} aria-label=\"Journal font picker\">\n                      <option value=\"Patrick Hand\">Patrick Hand</option>\n                      <option value=\"Indie Flower\">Indie Flower</option>\n                      <option value=\"Caveat\">Caveat</option>\n                    </select>\n                    <button className=\"prompt-btn\" onClick={() => setOpenFull(false)}>Close</button>\n                  </div>\n                </div>\n\n                <div className=\"modal-body\" style={{ alignItems: \"stretch\" }}>\n                  <div className=\"journal-list\" style={{ width: \"300px\" }}>\n                    <div className=\"journal-list-header muted\">Entries</div>\n                    <ul>\n                      {entries.map((e) => (\n                        <li key={e.entry_id} className={`journal-list-item ${selectedEntry?.entry_id === e.entry_id ? \"active\" : \"\"}`} onClick={() => setSelectedEntry(e)}>\n                          <div className=\"jl-title\">{e.title}</div>\n                          <div className=\"jl-date muted\">{new Date(e.created_at).toLocaleDateString()}</div>\n                        </li>\n                      ))}\n                    </ul>\n                  </div>\n\n                  <div className=\"journal-right\" style={{ flex: 1 }}>\n                    <div className=\"journal-new-row\" style={{ display: \"flex\", flexDirection: \"column\", gap: 8 }}>\n                      <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n                        <h4 style={{ margin: 0 }}>New Entry</h4>\n                        <button className=\"prompt-btn\" onClick={() => { setShowNewForm((s) => !s); setNewTitle(\"\"); setNewContent(\"\"); }}>\n                          {showNewForm ? \"Cancel\" : \"New\"}\n                        </button>\n                      </div>\n\n                      {showNewForm && (\n                        <div style={{ display: \"flex\", gap: 12 }}>\n                          <div style={{ width: 160 }}>\n                            <input className=\"journal-input title-input\" placeholder=\"Title\" value={newTitle} onChange={(e) => setNewTitle(e.target.value)} />\n                          </div>\n                          <div style={{ flex: 1 }}>\n                            <textarea className=\"journal-textarea\" placeholder=\"Write your entry...\" value={newContent} onChange={(e) => setNewContent(e.target.value)} style={{ fontFamily: fontChoice }} />\n                            <div style={{ display: \"flex\", gap: 8, marginTop: 8 }}>\n                              <button className=\"prompt-btn\" onClick={() => {\n                                const t = newTitle;\n                                const c = newContent;\n                                if (!t.trim() && !c.trim()) return;\n                                const entry: JournalEntry = { entry_id: `j${Date.now()}`, linked_session_id: \"\", title: t.trim() || \"Untitled\", content: c.trim(), created_at: new Date().toISOString(), source: \"user_written\" };\n                                const next = [entry, ...entries];\n                                persistEntries(next);\n                                setSelectedEntry(entry);\n                                setShowNewForm(false);\n                                setNewTitle(\"\");\n                                setNewContent(\"\");\n                              }}>Save Entry</button>\n                            </div>\n                          </div>\n                        </div>\n                      )}\n                    </div>\n\n                    <div className=\"journal-preview\" style={{ marginTop: 12 }}>\n                      {selectedEntry ? (\n                        editingEntryId === selectedEntry.entry_id ? (\n                          <div className=\"notebook-card\">\n                            <div className=\"note-head\">\n                              <div style={{ display: \"flex\", gap: 12, alignItems: \"center\" }}>\n                                <input className=\"journal-input title-input\" value={editTitle} onChange={(e) => setEditTitle(e.target.value)} />\n                                <div style={{ marginLeft: \"auto\", display: \"flex\", gap: 8 }}>\n                                  <button className=\"prompt-btn\" onClick={() => saveEdit(selectedEntry.entry_id)}>Save</button>\n                                  <button className=\"prompt-btn\" onClick={cancelEdit}>Cancel</button>\n                                </div>\n                              </div>\n                              <div className=\"muted\">{new Date(selectedEntry.created_at).toLocaleString()}</div>\n                            </div>\n                            <div className=\"note-body\">\n                              <textarea className=\"journal-textarea\" value={editContent} onChange={(e) => setEditContent(e.target.value)} style={{ fontFamily: fontChoice }} />\n                            </div>\n                          </div>\n                        ) : (\n                          <div className=\"notebook-card\">\n                            <div className=\"note-head\" style={{ display: \"flex\", alignItems: \"center\", gap: 12 }}>\n                              <strong>{selectedEntry.title}</strong>\n                              <div className=\"muted\">{new Date(selectedEntry.created_at).toLocaleString()}</div>\n                              <div style={{ marginLeft: \"auto\", display: \"flex\", gap: 8 }}>\n                                <button className=\"prompt-btn\" onClick={() => startEdit(selectedEntry)}>Edit</button>\n                                <button className=\"prompt-btn\" onClick={() => deleteEntry(selectedEntry.entry_id)}>Delete</button>\n                              </div>\n                            </div>\n                            <div className=\"note-body\">\n                              {selectedEntry.content.split(\"\\n\").map((ln, i) => (\n                                <div key={i} className=\"note-line\" style={{ fontFamily: fontChoice }}>{ln}</div>\n                              ))}\n                            </div>\n                          </div>\n                        )\n                      ) : (\n                        <div className=\"muted\">Select an entry from the left to view it here.</div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>,\n            document.body\n          )\n        : null}\n    </aside>\n  );\n}\n\n// Small form component for creating a journal entry (kept local)\nfunction JournalForm({ onSave }: { onSave: (e: JournalEntry) => void }) {\n  const [title, setTitle] = useState(\"\");\n  const [content, setContent] = useState(\"\");\n\n  function handleSave() {\n    if (!title.trim() && !content.trim()) return;\n    const entry: JournalEntry = {\n      entry_id: `j${Date.now()}`,\n      linked_session_id: \"\",\n      title: title.trim() || \"Untitled\",\n      content: content.trim(),\n      created_at: new Date().toISOString(),\n      source: \"user_written\",\n    };\n    onSave(entry);\n    setTitle(\"\");\n    setContent(\"\");\n  }\n\n  return (\n    <div>\n      <input className=\"journal-input\" placeholder=\"Title\" value={title} onChange={(e) => setTitle(e.target.value)} />\n      <textarea className=\"journal-textarea\" placeholder=\"Write your entry...\" value={content} onChange={(e) => setContent(e.target.value)} />\n      <div style={{ display: \"flex\", gap: 8 }}>\n        <button className=\"prompt-btn\" onClick={handleSave}>Save Entry</button>\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}